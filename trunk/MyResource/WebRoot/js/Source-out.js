var TLE=TLE||{};
TLE.exporter={"\u590d\u5236\u94fe\u63a5":function(a){console.log(a);var c='<ul style="max-height: 300px; overflow-y: scroll; overflow-x: hidden;">';$.each(a.tasklist,function(a,e){$.each(e.filelist,function(a,b){b.downurl&&(c+='<li><a href="'+TLE.url_rewrite(b.downurl,b.title)+'" target="_blank">'+b.title+"</a></li>")})});c+="</ul>";$("#TLE_text_pop").tpl("TLE_text_tpl",{title:"\u590d\u5236\u9009\u4e2d\u7684\u94fe\u63a5",content:c}).show().pop({onHide:function(){$(document.body).click()}})},Aria2:function(a){console.log(a);
var c="";$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){b.downurl&&(c+='aria2c -c -s10 -x10 --out "'+b.title+'" --header "Cookie: gdriveid='+a.gdriveid+';" "'+b.downurl+'"\n')})});TLE.text_pop("aria2 download command",c)},wget:function(a){console.log(a);var c="";$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){b.downurl&&(c+='wget -c -O "'+b.title+' --header "Cookie: gdriveid='+a.gdriveid+';" "'+b.downurl+'"\n')})});TLE.text_pop("wget download command",c)},YAAW:function(a){if(TLE.getConfig("TLE_aria2_jsonrpc")){show_tip("\u6dfb\u52a0\u4e2d...\u5230YAAW\u754c\u9762\u67e5\u770b\u662f\u5426\u6dfb\u52a0\u6210\u529f");
var c=new ARIA2(TLE.getConfig("TLE_aria2_jsonrpc"));$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){c.addUri(b.downurl,{out:b.title,header:"Cookie: gdriveid="+a.gdriveid})})})}else show_tip("\u5c1a\u672a\u8bbe\u7f6eAria2 JSONRPC\u5730\u5740");hide_tip()},"Aria2\u5bfc\u51fa":function(a){console.log(a);var c="";$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){b.downurl&&(c+=b.downurl+'\r\n  out="'+b.title+'"\r\n  header=Cookie: gdriveid='+a.gdriveid+"\r\n  continue=true\r\n  max-connection-per-server=5\r\n  split=10\r\n  parameterized-uri=true\r\n\r\n")})});
TLE.file_pop("Aria2\u5bfc\u51fa\u6587\u4ef6\u4e0b\u8f7d",c,"aria2.down")},"IDM\u5bfc\u51fa":function(a){console.log(a);var c="";$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){b.downurl&&(c+="<\r\n"+TLE.url_rewrite(b.downurl,b.title)+"\r\ncookie: gdriveid="+a.gdriveid+"\r\n>\r\n")})});TLE.file_pop("IDM\u5bfc\u51fa\u6587\u4ef6\u4e0b\u8f7d",c,"idm.ef2")},"Orbit\u5bfc\u51fa":function(a){console.log(a);var c="";$.each(a.tasklist,function(g,e){$.each(e.filelist,function(e,b){b.downurl&&
(c+=b.downurl+"|"+b.title.replace("|","_")+"||gdriveid="+a.gdriveid+"\r\n")})});TLE.file_pop("Orbit\u5bfc\u51fa\u6587\u4ef6\u4e0b\u8f7d",c,"orbit.olt")}};
(function(a){function c(d){var h=d.attr("taskid"),a={};d.find("input").each(function(d,c){var b=c.getAttribute("id").replace(h,"");a[b]=c.getAttribute("value")});return a}function g(d){var a={taskname:d.taskname,f_url:d.f_url,cid:d.dcid,size:parseInt(d.ysfilesize),tasktype:d.d_tasktype,status:d.d_status},i=[];i.push({title:f(d.taskname),f_url:d.f_url,downurl:d.dl_url,cid:d.dcid,gcid:"",size:parseInt(d.ysfilesize)});a.filelist=i;return a}function e(d,a){var i={taskname:d.taskname,f_url:d.f_url,cid:d.dcid,
size:parseInt(d.ysfilesize),tasktype:d.d_tasktype,status:d.d_status},c=[];$.each(a,function(d,a){c.push({title:f(a.title),f_url:a.url,downurl:a.downurl,cid:a.cid,gcid:a.gcid,size:parseInt(a.filesize)})});i.filelist=c;return i}function f(d){return d.replace(/[\\\|\:\*\"\?\<\>]/g,"_")}function b(d){d=d.toString(16);return 1==d.length?"0"+d:d}function l(d){var a=["01"];for($.each(unescape(encodeURIComponent(d)),function(d,c){a.push(b(c.charCodeAt(0)^n[d%8]).toUpperCase())});1!=a.length%8;)a.push(b(n[(a.length-
1)%8]).toUpperCase());return a.join("")}a.down=function(a,h){var i=$(a).parents(".rw_list"),b=c(i);"0"==b.d_tasktype?(show_tip("\u8f7d\u5165\u4e2d..."),$.getJSON(INTERFACE_URL+"/fill_bt_list?tid="+b.input+"&g_net="+G_section+"&uid="+G_USERID+"&callback=?",function(a){hide_tip();var d={};d.gdriveid=getCookie("gdriveid");d.tasklist={};d.tasklist[b.input]=e(b,a.Result[b.input]);h(d)})):(i={},i.gdriveid=getCookie("gdriveid"),i.tasklist={},i.tasklist[b.input]=g(b),h(i))};a.batch_down=function(a,h){var b=
document.getElementsByName("ck"),k=[],f=[];$.each(b,function(a,d){if(!1!=d.checked){var b=d.value,h=$("#d_status"+b).val(),c=$("#d_tasktype"+b).val();4!=$("#dflag"+b).val()&&2==h&&(0==c?k.push(b):f.push(b))}});if(k.length)show_tip("\u8f7d\u5165\u4e2d..."),$.getJSON(INTERFACE_URL+"/fill_bt_list?tid="+k.join(",")+"&g_net="+G_section+"&uid="+G_USERID+"&callback=?",function(a){hide_tip();var d={};d.gdriveid=getCookie("gdriveid");d.tasklist={};$.each(a.Result,function(a,b){var h=c($("#tr_c"+a));d.tasklist[a]=
e(h,b)});$.each(f,function(a,b){var h=c($("#tr_c"+b));d.tasklist[b]=g(h)});h(d)});else{var j={};j.gdriveid=getCookie("gdriveid");j.tasklist={};$.each(f,function(a,d){var b=c($("#tr_c"+d));j.tasklist[d]=g(b)});h(j)}};a.bt_down=function(d,a){var b=document.getElementsByName("bt_list_ck"),k=[];$.each(b,function(a,d){if(!1!=d.checked){var b=d.getAttribute("_i"),b={title:f($("#bt_taskname"+b).val()),url:$("#bturl"+b).val(),downurl:$("#btdownurl"+b).val(),cid:$("#btcid"+b).val(),gcid:$("#btgcid"+b).val(),
filesize:$("#bt_filesize"+b).val()};k.push(b)}});var b=$("#view_bt_taskid").val(),g=c($("#tr_c"+b)),j={};j.gdriveid=getCookie("gdriveid");j.tasklist={};j.tasklist[b]=e(g,k);console.log(j);a(j);console.log("bt_down")};a.getbtn=function(d){$(d).parents(".TLE_get_btnbox").find(".TLE_p_getbtn").toggle();close_rightmenu_layer();return!1};a.text_pop=function(d,a){a=$("<div></div>").text(a).html();a='<textarea style="width: 100%; height: 260px;">'+a+"</textarea>";$("#TLE_text_pop").tpl("TLE_text_tpl",{title:d,
content:a}).show().pop({onHide:function(){$(document.body).click()}})};a.file_pop=function(a,b,c){b='<div style="width: 100%; height: 100px;"><div style="padding: 30px 0 0 30%;"><a href="data:text/html;charset=utf-8,'+encodeURIComponent(b)+'" target="_blank" title="\u53f3\u952e\u53e6\u5b58\u4e3a" class="TLE_down_btn" download="'+c+'"><span><em class="TLE_icdwlocal">\u5bfc\u51fa\u6587\u4ef6</em></span></a>'+(isChrome?"":"(\u53f3\u952e\u53e6\u5b58\u4e3a"+c+")")+"</div></div>";$("#TLE_text_pop").tpl("TLE_text_tpl",
{title:a,content:b}).show().pop({onHide:function(){$(document.body).click()}})};a.window_pop=function(a,b){$("#TLE_text_pop").tpl("TLE_text_tpl",{title:a,content:b}).show().pop({onHide:function(){$(document.body).click()}})};a.multiple_server_fix=function(a){return"'"+a.replace("gdl","'{gdl,dl.{f,g,h,i,twin}}'")+"'"};var n=[97,49,228,95,0,0,0,0];a.url_rewrite=function(a,b){return a=a.replace(/&n=\w+/,"&n="+l(b))};a.escape_command=function(a){for(var b="",c=0;c<a.length;c++)b=-1=="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".indexOf(a[c])?
b+("\\"+a[c]):b+a[c];return b};var m=function(b){var c=a.getConfig("TLE_exporter").split("|"),e="";$.each(a.exporter,function(a){-1!=c.indexOf(a)&&(e+='<a href="#" title="'+a+'" onmouseover="this.className=\'sel_on\'" onmouseout="this.className=\'\'" onclick="'+b+"(this, TLE.exporter['"+a+"'])\">"+a+"</a>")});return e};$("head").append("<style>.TLE_get_btnbox {position:relative; float:left; z-index:11}.TLE_getbtn {position: absolute; top:24px; left:0; border:1px #6FB2F3 solid; background:#fff; width:115px;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;-moz-box-shadow:2px 2px 3px #ddd;-webkit-box-shadow:2px 2px 3px #ddd;}.TLE_getbtn a {display:block; height:22px; line-height:22px; padding-left:18px}.TLE_getbtn a:hover {background:#E4EFF9 url(http://cloud.vip.xunlei.com/190/img/ic_dianbo.png) no-repeat 8px 8px; *background-position:8px 6px ; text-decoration:none}.TLE_get_btnbox .TLE_getlink {width:98px; height:22px; float:left; line-height:21px;*line-height:24px;display:block;color:#000000; margin-right:5px; overflow:hidden;background:url(http://cloud.vip.xunlei.com/190/img/bg_btnall.png?197) no-repeat  0 -390px}.TLE_get_btnbox .TLE_link_gettxt {float:left; display: inline ; width:53px; text-align:center; padding-left:24px; color:#000}.TLE_get_btnbox .TLE_link_gettxt:hover {text-decoration:none}.rwbox .rwset .TLE_link_getic {float:left; display:block; width:20px;height:22px;}.TLE_hiden {display: none; }.TLE_down_btn {background: url(http://cloud.vip.xunlei.com/190/img/lx/bg_rpx.png) no-repeat 0 999em; display: block; float: left; margin: 0 1px; overflow: hidden; color: white; height: 28px; padding-left: 8px; background-position: 0 -60px; text-decoration: none; }.TLE_down_btn span {background: url(http://cloud.vip.xunlei.com/190/img/lx/bg_rpx.png) no-repeat 0 999em; display: block; float: left; height: 28px; line-height: 27px; cursor: pointer; padding-right: 8px; background-position:100% -60px; }.TLE_down_btn:active {background-position:0 -28px; }.TLE_down_btn:active span {background-position:right -28px;}.TLE_icdwlocal { padding-left: 20px; display: inline-block; background: url(http://cloud.vip.xunlei.com/190/img/lx/bg_menu.png) no-repeat 0 999em; background-position: 0 -108px; }.rwbtn.ic_redownloca { display: none !important; }.menu { width: 630px !important; }</style>");
$("body").append('<div id="TLE_text_pop" class="pop_rwbox" style="display: none;margin: 0;"></div>');$("body").append('<textarea id="TLE_text_tpl" style="display: none;"></textarea>');$("#TLE_text_tpl").text('<div class="p_rw_pop"><div class="tt_box onlytitle"><h3>$[title]</h3></div><div class="psc_info">$[content]</div><a href="#" class="close" title="\u5173\u95ed">\u5173\u95ed</a></div>');a.getConfig=function(a){return window.localStorage?window.localStorage.getItem(a)||"":getCookie(a)};a.setConfig=
function(a,b){window.localStorage?window.localStorage.setItem(a,b):setGdCookie(a,b,31536E3)};if(""==a.getConfig("TLE_exporter")){var o=[],p;for(p in a.exporter)o.push(p);a.setConfig("TLE_exporter",o.join("|"))}$("#setting_main_tpl").text($("#setting_main_tpl").text().replace(/(<\/div>\s+<div class="btnin">)/,'<div class="doline mag01"></div><h3 style="background-position: 0 -180px;">Thunder Lixian Exporter \u8bbe\u5b9a</h3><ul><li><b>\u542f\u7528\u4ee5\u4e0b\u5bfc\u51fa\u5668</b></li><li>'+function(){var b=
a.getConfig("TLE_exporter").split("|"),c="",e;for(e in a.exporter)c+='<span class="rw_col"><input type="checkbox" class="TLE_setting_ck" name="TLE_ck_'+e+'" '+(-1==b.indexOf(e)?"":"checked")+" />"+e+"</span>";return c}()+'</li><li><b>Aria2 JSON-RPC Path</b></li><li>Path: <input type="text" id="TLE_aria2_jsonrpc" style="width: 350px" value="'+a.getConfig("TLE_aria2_jsonrpc")+'"/></li></ul>$1'));var q=set_notice_submit;set_notice_submit=function(b){q(b);var c=[];$(".TLE_setting_ck").each(function(a,
b){b.checked&&c.push(b.name.replace(/^TLE_ck_/,""))});var b=0==c.length?"_":c.join("|"),e=$("#TLE_aria2_jsonrpc").val();if(a.getConfig("TLE_exporter")!=b||a.getConfig("TLE_aria2_jsonrpc")!=e)a.setConfig("TLE_exporter",b),a.setConfig("TLE_aria2_jsonrpc",e),TS2.show("\u8bbe\u7f6e\u5df2\u751f\u6548",1),setTimeout(function(){setting.hide();location.reload(!0)},1E3)};$(".rwbtn.ic_redownloca").each(function(a,b){$(b).after('<div class="TLE_get_btnbox"><span class="TLE_getlink"><a href="#" class="TLE_link_gettxt TLE-down-text" style="padding-left: 20px; width: 57px;" onclick='+
b.getAttribute("onclick")+'>\u53d6\u56de\u672c\u5730</a><a href="#" class="TLE_link_getic TLE-down-btn" onclick="return TLE.getbtn(this);"></a></span><div class="TLE_p_getbtn TLE_getbtn" style="display: none;">'+m("TLE.down")+"</div></div>")});$("#li_task_down").after('<a href="#" id="TLE_batch_down" title="\u6279\u91cf\u5bfc\u51fa" class="btn_m noit"><span><em class="icdwlocal">\u6279\u91cf\u5bfc\u51fa</em></span></a>').parents(".main_link").append('<div id="TLE_batch_getbtn" class="TLE_getbtn" style="top: 30px; display:none;">'+
m("TLE.batch_down")+"</div>");var r=task_check_click;task_check_click=function(){r();$("#li_task_down").hasClass("noit")?$("#TLE_batch_down").addClass("noit").unbind("click"):$("#TLE_batch_down").removeClass("noit").unbind("click").click(function(){$("#TLE_batch_getbtn").css("left",$("#TLE_batch_down").position().left);$("#TLE_batch_getbtn").toggle();return!1});console.log("task_check_click called")};$("input[name=ck]").click(task_check_click);$("#view_bt_list_nav_tpl").text($("#view_bt_list_nav_tpl").text().replace('<a href="#" class="btn_m noit" title="\u4e91\u8f6c\u7801"',
'<a href="#" class="btn_m noit" title="\u6279\u91cf\u5bfc\u51fa" id="TLE_bt_down"><span><em class="icdwlocal">\u6279\u91cf\u5bfc\u51fa</em></span></a><div id="TLE_bt_getbtn" class="TLE_getbtn" style="top: 30px; display:none;">'+m("TLE.bt_down")+'</div><a href="#" class="btn_m noit" title="\u4e91\u8f6c\u7801"'));var s=bt_view_nav;bt_view_nav=function(){s();$("#view_bt_list_nav_down").hasClass("noit")?$("#TLE_bt_down").addClass("noit").unbind("click"):$("#TLE_bt_down").removeClass("noit").unbind("click").click(function(){$("#TLE_bt_getbtn").css("left",
$("#TLE_bt_down").position().left);$("#TLE_bt_getbtn").toggle();return!1});$("#TLE_bt_getbtn").hide();console.log("bt_view_nav called")};$(document.body).bind("click",function(){$("div.TLE_p_getbtn, #TLE_batch_getbtn, #TLE_bt_getbtn").hide()});$("div.rw_list").click(function(){$("div.TLE_p_getbtn, #TLE_batch_getbtn, #TLE_bt_getbtn").hide()});$("div.TLE_get_btnbox").click(function(a){a.stopPropagation()})})(TLE);
var ARIA2=function(){return function(a){this.jsonrpc_path=a;this.addUri=function(a,g){var e=this.jsonrpc_path,f=[[a],g],b={jsonrpc:"2.0",method:"aria2.addUri",id:(new Date).getTime().toString()};f&&(b.params=f);var f=new XMLHttpRequest,l=e.match(/^(?:(?![^:@]+:[^:@\/]*@)[^:\/?#.]+:)?(?:\/\/)?(?:([^:@]*(?::[^:@]*)?)?@)?/)[1];f.open("POST",e+"?tm="+(new Date).getTime().toString(),!0);f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");l&&f.setRequestHeader("Authorization",
"Basic "+btoa(l));f.send(JSON.stringify(b))};return this}}();
